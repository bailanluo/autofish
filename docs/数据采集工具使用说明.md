# 通用图像数据采集工具 v2.1 使用说明

## 🎯 工具特点

本工具是一个**通用图像数据采集工具**，专注于快速、高效的截图数据收集：

- ✅ **通用设计**：支持任意自定义类别，不限于特定领域
- ✅ **操作简洁**：两步操作即可完成数据采集
- ✅ **智能管理**：自动文件命名、目录创建、增量采集
- ✅ **热键支持**：全局快捷键，提高采集效率
- ✅ **实时预览**：截图成功后立即显示预览
- ✅ **美观统计**：标签式统计界面，点击打开文件夹
- ✅ **暂停控制**：一键暂停/恢复截图功能

## 🚀 快速开始

### 1. 启动工具

```bash
# 直接启动数据采集工具
python modules/data_collector/main.py

# 或通过主程序启动
python main.py
# 选择 "启动数据采集" 选项
```

### 2. 基本操作流程

#### 🔸 第一步：设置类别和区域
- 按 `Ctrl+Alt+Y` 或点击"选择区域并设置类别"按钮
- 在半透明覆盖界面上拖拽鼠标选择截图区域
- 在弹出对话框中输入数据类别名称
- 如果类别已存在，会提示续编号采集

#### 🔸 第二步：快速截图
- 按 `Y` 键或点击"快速截图"按钮
- 图像自动保存到对应类别文件夹
- 预览面板显示最新截图
- 统计面板实时更新数据量

#### 🔸 第三步：管理数据
- 点击统计面板中的类别标签直接打开文件夹
- 使用 `Ctrl+Alt+P` 暂停/恢复截图功能
- 查看实时统计信息和数据收集进度

## ⌨️ 快捷键

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `Ctrl+Alt+Y` | 选择截图区域并设置类别 | 全局热键，任何时候都可以使用 |
| `Y` | 快速截图 | 需要先设置类别，支持暂停/恢复 |
| `Ctrl+Alt+P` | 暂停/恢复截图功能 | 只暂停Y键响应，不影响其他功能 |
| `ESC` | 取消区域选择 | 在区域选择界面按ESC取消 |

### 🎮 热键自定义
- 点击界面上的"⚙️ 热键设置"按钮
- 在弹出对话框中点击对应的"🎯 点击检测"按钮
- 按下你想要设置的热键组合
- 支持单键（如Y）和组合键（如Ctrl+Alt+Y）

## 📁 数据组织

### 文件命名规则
```
data/
├── 类别名1/
│   ├── 类别名1_001.png
│   ├── 类别名1_002.png
│   └── ...
├── 类别名2/
│   ├── 类别名2_001.png
│   └── ...
└── ...
```

### 🔄 增量数据采集
- **智能续编号**：重复输入相同类别时，自动从最大编号继续
- **数据提示**：显示现有数据量，确认是否继续采集
- **无缝衔接**：新旧数据自动合并，编号连续

### 类别命名建议
- **钓鱼项目**：`fish_hooked`, `idle`, `fishing_success`, `fishing_failed`
- **UI分类**：`login_button`, `error_dialog`, `success_message`
- **物体识别**：`car_red`, `dog`, `cat`, `house`

## 📊 统计界面

### 美观的标签式显示
- **类别标签**：每个类别用独立的美观标签显示
- **数量显示**：图片数量固定在标签右侧，格式为"XX 张"
- **当前类别**：正在使用的类别显示绿色高亮
- **智能布局**：类别名过长时自动截断，确保数量显示

### 🖱️ 交互功能
- **点击打开**：点击任意类别标签直接打开对应文件夹
- **悬停效果**：鼠标悬停时指针变为手指，背景和文字颜色改变
- **点击反馈**：点击时有黄色高亮反馈，150ms后恢复
- **滚动支持**：类别多时支持鼠标滚轮在任意位置滚动

## ⏸️ 暂停功能

### 简单的暂停控制
- **热键暂停**：`Ctrl+Alt+P` 暂停/恢复Y键截图功能
- **按钮暂停**：点击界面上的"⏸️ 暂停"/"▶️ 恢复"按钮
- **状态显示**：按钮文字动态显示当前状态和对应热键

### 使用场景
- 临时离开时暂停截图，避免误触发Y键
- 调整游戏/应用设置时暂停截图
- 需要专注其他操作时使用
- 切换应用程序时避免错误截图

## 🖼️ 图片预览

### 自适应显示
- **智能缩放**：图片自动适应预览区域大小，最大化利用空间
- **保持比例**：缩放时保持原始宽高比，不变形
- **居中显示**：缩放后的图片居中显示在预览区域
- **最小尺寸**：确保预览图片有合适的最小尺寸

## 🎯 使用示例

### 钓鱼项目数据收集
1. 启动游戏，进入钓鱼界面
2. 按 `Ctrl+Alt+Y`，选择游戏窗口区域
3. 输入类别名：`fish_hooked`
4. 当鱼上钩时，按 `Y` 键截图
5. 重复步骤2-3设置其他类别：`idle`, `fishing_success`等
6. 需要暂停时按 `Ctrl+Alt+P`，恢复时再按一次
7. 继续按 `Y` 键收集对应状态的截图

### 通用UI元素收集
1. 打开目标应用程序
2. 按 `Ctrl+Alt+Y`，选择需要截图的UI区域
3. 输入类别名：`login_button`
4. 按 `Y` 键截图
5. 切换到其他UI元素，重复上述步骤
6. 点击统计面板中的类别标签查看收集的数据

### 增量数据采集示例
1. 第一次采集：输入类别名`car_red`，收集10张图片
2. 几天后继续：再次输入`car_red`，提示"已有10张图片，将从编号11开始"
3. 确认后继续采集，新图片自动命名为`car_red_011.png`等

## 🔧 配置选项

配置文件位置：`modules/data_collector/config.yaml`

```yaml
# 数据采集设置
data_collection:
  image_format: png          # 图像格式
  image_quality: 95          # 图像质量
  data_dir: data            # 数据保存目录
  max_images_per_category: 1000  # 每类别最大图像数

# 热键设置（可通过界面自定义）
hotkeys:
  select_region: ctrl+alt+y      # 选择区域热键
  quick_capture: y               # 快速截图热键
  pause_capture: ctrl+alt+p      # 暂停截图热键

# 界面设置
ui:
  window_title: "通用图像数据采集工具"
  window_size: "1000x700"        # 窗口大小
  preview_size: 200              # 预览区域大小
```

## ⚠️ 注意事项

1. **类别命名**：建议使用英文和下划线，避免特殊字符
2. **区域选择**：确保选择区域足够大（最小10x10像素）
3. **热键冲突**：如与其他软件冲突，可通过界面自定义热键
4. **数据备份**：重要数据请及时备份
5. **权限要求**：需要屏幕截图权限，Windows下可能需要管理员权限
6. **暂停状态**：暂停时Y键不响应，其他功能正常

## 🔍 故障排除

### 热键无响应
- 检查是否与其他软件快捷键冲突
- 尝试通过界面自定义热键
- 以管理员权限运行程序
- 查看日志文件：`logs/HotkeyListener_*.log`

### 截图失败
- 确认已正确选择区域和设置类别
- 检查磁盘空间是否充足
- 查看日志文件：`logs/ScreenCapture_*.log`

### Y键暂停无法恢复
- 按 `Ctrl+Alt+P` 或点击界面恢复按钮
- 重新选择区域和类别
- 检查暂停按钮的状态显示

### 图片数量显示不全
- 已优化显示布局，确保数量在右侧显示
- 如仍有问题，尝试调整窗口大小

### 鼠标滚轮无效
- 已修复滚轮绑定问题，现在在标签区域也能滚动
- 确保鼠标驱动正常

## 📝 日志文件

所有操作都有详细日志记录，位置：`logs/` 目录

- `DataCollectorApp_*.log`：主程序日志
- `HotkeyListener_*.log`：热键监听日志
- `ScreenCapture_*.log`：截图操作日志
- `DataManager_*.log`：数据管理日志

## 🚀 下一步

数据收集完成后，可以：

1. **第三阶段**：使用收集的数据训练YOLO模型
2. **第四阶段**：部署训练好的模型进行自动化操作
3. **数据分析**：使用OCR工具批量分析图像中的文字内容

---

*通用图像数据采集工具 v2.1 - 简洁、高效、智能的数据收集解决方案* 