# Fisher钓鱼模块管理员权限设置说明

## 为什么需要管理员权限？

Fisher钓鱼模块需要管理员权限的原因：

1. **游戏输入控制** - 在游戏全屏模式下控制鼠标和键盘
2. **屏幕访问** - 访问游戏窗口进行屏幕截取和状态检测
3. **输入模拟** - 模拟按键输入到游戏程序
4. **权限绕过** - 绕过某些游戏的输入保护机制
5. **系统级操作** - 进行底层的窗口和进程操作

## 启动方式

### 🚀 推荐方式：自动管理员启动

#### 方式1：使用批处理脚本（推荐）
```bash
# 双击运行
启动Fisher钓鱼_管理员.bat
```

#### 方式2：使用PowerShell脚本
```powershell
# 右键 -> 以管理员身份运行
启动Fisher钓鱼_管理员.ps1
```

#### 方式3：程序内自动提升
```bash
# 程序会自动检查并请求管理员权限
python modules/fisher/main.py
```

### 📋 手动管理员启动

#### 方式1：右键启动
1. 右键点击 `启动Fisher钓鱼.bat`
2. 选择 **"以管理员身份运行"**

#### 方式2：管理员命令提示符
1. 按 `Win + X`，选择 **"Windows PowerShell(管理员)"**
2. 切换到项目目录：`cd "项目路径"`
3. 运行：`python modules/fisher/main.py`

#### 方式3：修改程序属性
1. 右键点击 `启动Fisher钓鱼.bat`
2. 选择 **"属性"**
3. 点击 **"高级"** 按钮
4. 勾选 **"用管理员身份运行"**
5. 点击 **"确定"** 保存

## 权限检查

### 自动检查
程序启动时会自动检查管理员权限：

```
检查管理员权限...
✅ 已获得管理员权限
```

### 手动检查
可以单独测试管理员权限功能：

```bash
python modules/fisher/admin_utils.py
```

## 启动脚本说明

### 启动Fisher钓鱼.bat
- **功能**: 普通启动，会提示管理员权限状态
- **特点**: 可以普通权限运行，但建议使用管理员权限
- **使用**: 双击运行

### 启动Fisher钓鱼_管理员.bat
- **功能**: 自动请求管理员权限启动
- **特点**: 会弹出UAC提示，需要用户确认
- **使用**: 双击运行，确认UAC提示

### 启动Fisher钓鱼_管理员.ps1
- **功能**: PowerShell版本的管理员启动
- **特点**: 更好的错误处理和状态显示
- **使用**: 右键 -> 以管理员身份运行

## 常见问题

### Q: 为什么程序无法控制游戏？
A: 可能是权限不足。请确保以管理员身份运行程序。

### Q: UAC提示是什么？
A: 用户账户控制(UAC)是Windows的安全机制，需要确认才能获得管理员权限。

### Q: 如何永久以管理员身份运行？
A: 
1. 右键程序 -> 属性 -> 兼容性
2. 勾选"以管理员身份运行此程序"
3. 点击确定

### Q: 程序启动后仍然没有权限？
A: 
1. 检查是否真的以管理员身份运行
2. 尝试重新启动计算机
3. 检查杀毒软件是否阻止了程序

### Q: 如何在不同用户账户下运行？
A: 
1. 右键程序 -> 以其他用户身份运行
2. 输入管理员账户凭据
3. 勾选"以管理员身份运行"

## 安全说明

### 权限使用
- 程序只在必要时使用管理员权限
- 不会修改系统设置或安装文件
- 仅用于键鼠控制和屏幕访问

### 杀毒软件
- 某些杀毒软件可能会警告管理员权限程序
- 这是正常的安全检查
- 可以将程序添加到白名单

### 防火墙
- 程序不需要网络连接
- 如果防火墙询问，可以选择阻止网络访问

## 故障排除

### 权限检查失败
```bash
# 测试管理员权限
python -c "import ctypes; print('Admin:', ctypes.windll.shell32.IsUserAnAdmin())"
```

### 程序无法启动
1. 检查Python环境是否正确
2. 确认依赖包是否完整安装
3. 验证模型文件是否存在
4. 检查Tesseract OCR配置

### 游戏中无响应
1. 确认程序以管理员身份运行
2. 检查游戏是否有输入保护
3. 尝试在窗口模式下测试
4. 检查热键是否被其他程序占用

## 技术细节

### 权限检查原理
```python
import ctypes

def is_admin():
    try:
        return ctypes.windll.shell32.IsUserAnAdmin()
    except:
        return False
```

### 权限提升原理
```python
import ctypes

def run_as_admin(script_path):
    ctypes.windll.shell32.ShellExecuteW(
        None, "runas", sys.executable, f'"{script_path}"', None, 1
    )
```

### 批处理权限检查
```batch
net session >nul 2>&1
if %errorLevel% == 0 (
    echo 已获得管理员权限
) else (
    echo 需要管理员权限
)
```

---

## 版本信息

- **文档版本**: v1.0.1
- **适用程序**: Fisher钓鱼模块 v1.0.1+
- **更新日期**: 2024-12-28
- **兼容系统**: Windows 10/11

---

*如有问题，请参考程序日志或联系技术支持* 